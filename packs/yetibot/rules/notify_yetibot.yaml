---
name: "notify_yetibot"
enabled: true
description: "Notification rule to send messages to Yetibot"
trigger:
  type: "core.st2.generic.notifytrigger"
criteria:
  trigger.route:
    pattern: "yetibot"
    type: "equals"
action:
  ref: core.http
  parameters:
    method: POST
    body: "chat-source={{trigger.data.source_channel|urlencode}}&text={{trigger.message}}\n{{trigger.data.result|replace('|','.')|urlencode}}"
    url: "{{system.yetibot_endpoint}}/api"
    headers: 'content-type=application/x-www-form-urlencoded'
